<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Implementing infrastructure-as-code with Ansible and GIT | SerDigital64</title>

    



<meta name="author" content="SerDigital64" />
<meta name="description" content="Blog dedicated to sharing personal experiences and knowledge on Information Technology topics" />



<meta name="generator" content="Hugo 0.80.0" />

<link rel="canonical" href="https://serdigital64.github.io/post/ansible/implementing-infrastructure-as-code-with-ansible-and-git/" />


<meta property="og:title" content="Implementing infrastructure-as-code with Ansible and GIT" />
<meta property="og:description" content="Manage compute nodes using the infrastructure-as-code concept using Ansible and GIT" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://serdigital64.github.io/post/ansible/implementing-infrastructure-as-code-with-ansible-and-git/" />
<meta property="article:published_time" content="2021-09-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-09-18T00:00:00+00:00" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Implementing infrastructure-as-code with Ansible and GIT"/>
<meta name="twitter:description" content="Manage compute nodes using the infrastructure-as-code concept using Ansible and GIT"/>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
<link rel="stylesheet" href="/css/icomoon.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/overlayscrollbars@1.13.1/css/OverlayScrollbars.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css">
<link rel="stylesheet" href="/css/site.css" />

<style>
  .ui.header a:not(.item, .ui.button):hover {
    text-decoration: underline;
  }

  
  a:not(.item, .ui.button) {
    color: seagreen !important;
  }
  

  
  .inverted a:not(.item, .ui.button) {
     color: darkseagreen !important;
  }
  

  
  body.default {
    
    background-color: #f7f7f7;
    

    
    background-image: url(from-serdigital64-flicker/DSC_2253-tall.jpg);
    
  }
  

  
  body.dark {
    
    background-color: black;
    

    
    background-image: url(from-serdigital64-flicker/DSC_2253-tall.jpg);
    
  }
  
</style>


    







    
  </head>

  <body class="default">
    
<nav class="ui secondary menu dream-menu dream-nav">

  <a class="item dream-flip-toggle" title="">
    <i class="large link bullseye icon"></i>
  </a>
  <a class="item" href="https://serdigital64.github.io" title="">
    <i class="large link home icon"></i>
  </a>
  
  <a class="item" onclick="themeSwitch(event)">
    <i class="large link icon theme-switch"></i>
  </a>
  
  
  <a class="item" title="" onclick="toggleSearch(event)">
    <i class="large link search icon"></i>
  </a>
  
</nav>

    <div class="flip-container">
      <div class="flipper">
        <section class="front">
          <div class="dream-max-width">
            
<div class="ui relaxed centered grid dream-grid dream-grid-single"style="flex-direction: row-reverse;">
  
  
  
  

  
  <aside class="sixteen wide mobile sixteen wide tablet three wide computer column dream-single-aside">
    
    <div class="ui segment toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-infrastructure-as-code">What is &ldquo;infrastructure-as-code&rdquo;?</a></li>
    <li><a href="#challenges">Challenges</a></li>
    <li><a href="#implementing-infrastructure-as-code">Implementing infrastructure-as-code</a>
      <ul>
        <li><a href="#define-the-infrastructure-model">Define the Infrastructure Model</a></li>
        <li><a href="#create-the-code-repository">Create the Code Repository</a></li>
        <li><a href="#configure-ansible">Configure Ansible</a></li>
        <li><a href="#define-component-end-states">Define component end-states</a></li>
        <li><a href="#bring-the-site-to-the-target-end-state">Bring the site to the target end-state</a></li>
      </ul>
    </li>
    <li><a href="#next-steps">Next steps</a></li>
    <li><a href="#copyright-information">Copyright information</a></li>
    <li><a href="#disclaimer">Disclaimer</a></li>
  </ul>
</nav>
    </div>
    

    
  </aside>
  
  <div class="sixteen wide mobile sixteen wide tablet ten wide computer column markdown-body dream-single" id="dream-save-post-as-img">
    <section class="ui top attached segment">
      <header>
        <h1 class="ui large header">Implementing infrastructure-as-code with Ansible and GIT<span class="sub header">
            <span class="left">
              @
              
                SerDigital64
              

              | 
                  
                    Saturday, Sep 4, 2021
                  
                

              | 8

              
              | 
                
                  
                    Saturday, Sep 18, 2021
                  
                
              
            </span>

            
            <span class="dream-share">
  <a href="#" class="save-as-image" title="" onclick="savePostAsImg()">
    <i class="save icon"></i>
  </a>
  <a href="https://twitter.com/intent/tweet?text=Implementing%20infrastructure-as-code%20with%20Ansible%20and%20GIT&url=https%3a%2f%2fserdigital64.github.io%2fpost%2fansible%2fimplementing-infrastructure-as-code-with-ansible-and-git%2f" title="Twitter">
    <i class="twitter icon"></i>
  </a>
  <a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fserdigital64.github.io%2fpost%2fansible%2fimplementing-infrastructure-as-code-with-ansible-and-git%2f" title="Facebook">
    <i class="facebook icon"></i>
  </a>
</span>

            
          </span>
        </h1>
      </header>

      <article class="main">
        
        <img class="cover" src="/from-serdigital64-flicker/DSC_7075-wide.jpg" />
        

        <h2 id="what-is-infrastructure-as-code">What is &ldquo;infrastructure-as-code&rdquo;?</h2>
<p>To keep the concept simple, think of your infrastructure as a picture (end-state) and the main characteristics (configuration) that you would use to describe it.</p>
<p>Using this information you should be able to reproduce the picture any time you need, and the result should always be the same as the original.</p>
<p>There are several tools and methods to implement this approach but the most important thing to consider is that you also need to adapt your management procedures to switch from the traditional imperative model to the infrastructure-as-code declarative model.</p>
<h2 id="challenges">Challenges</h2>
<p>To successfully implement infrastructure-as-code special attention must be paid to the selection of supporting tools and the definition of the conceptual model that will represent the managed environment:</p>
<ul>
<li>Automation tool: takes control of the infrastructure configuration and performs the necessary actions to reach the desired end-state.</li>
<li>Code Repository and Versioning: stores the infrastructure-model and automation scripts to manage the infrastructure and tracks changes.</li>
<li>Infrastructure-model: conceptual data model that describes the desired end-state of the infrastructure.</li>
</ul>
<h2 id="implementing-infrastructure-as-code">Implementing infrastructure-as-code</h2>
<p>Let&rsquo;s take the following example scenario to demonstrate the implementation procedure:</p>
<ul>
<li>Environment: Home Office</li>
<li>Ansible Control Node: small PC or VM installed with Centos 8.4</li>
<li>Ansible Managed Nodes: notebooks with Ubuntu and workstations with Centos and Fedora</li>
</ul>
<p><img src="/diagrams/implementing-infrastructure-as-code-with-ansible-and-git-1.png" alt="Home Office Site"></p>
<p>Before starting the implementation procedure, make sure the following requirements are meet:</p>
<ul>
<li>Control Node:
<ul>
<li>OpenSSH client</li>
<li>Sudo</li>
<li>Python3</li>
<li>GIT</li>
<li>Regular user with SUDO configured for password less root privilege</li>
</ul>
</li>
<li>Managed Nodes:
<ul>
<li>Fresh OS install (standard setup)</li>
<li>OpenSSH server</li>
<li>Sudo</li>
<li>Python3</li>
<li>Regular user with SUDO configured for password less root privilege</li>
</ul>
</li>
</ul>
<h3 id="define-the-infrastructure-model">Define the Infrastructure Model</h3>
<p>The infrastructure-model will have the following data structures:</p>
<ul>
<li><strong>Site</strong>: Represents a group of <strong>Nodes</strong> that are managed by the same <strong>Control Node</strong>.</li>
<li><strong>Node</strong>: Compute node that is capable of hosting software components and that is fully managed by the Control Node.</li>
<li><strong>Component</strong>: Individual software product that is installed in a <strong>Node</strong>.</li>
<li><strong>Service</strong>: Group of <strong>Components</strong> configured in one or more <strong>Nodes</strong> to serve a particular function.</li>
</ul>
<p>The data structures will be implemented using Ansible inventories, host_vars, and group_vars:</p>
<ul>
<li><strong>Inventory</strong>: the <code>hosts.ini</code> file will be used to declare all the <strong>Nodes</strong> for the target <strong>Site</strong>. <strong>Nodes</strong> will be grouped based on the <strong>Service</strong> they provide or use.</li>
<li><strong>GroupVars</strong>: individual YAML files for <strong>Components</strong> and <strong>Services</strong> will be created for each <strong>Node</strong> group declared in the <strong>Inventory</strong>.</li>
<li><strong>HostVars</strong>: individual YAML files will be used for cases where the <strong>Node</strong> requires further customization.</li>
</ul>
<h3 id="create-the-code-repository">Create the Code Repository</h3>
<p>Create a dedicated Linux account. This is to isolate content from regular users and facilitate activity auditing. Modify the shell variable <code>PROJECT_OWNER</code> to change the default name.</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">PROJECT_OWNER=<span style="color:#0ff;font-weight:bold">&#39;sitectl&#39;</span>
sudo useradd -m <span style="color:#0ff;font-weight:bold">&#34;</span>$PROJECT_OWNER<span style="color:#0ff;font-weight:bold">&#34;</span>
sudo su - <span style="color:#0ff;font-weight:bold">&#34;</span>$PROJECT_OWNER<span style="color:#0ff;font-weight:bold">&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Create the project directory structure that will contain the infrastructure-model and automation scripts. Refer to the <a href="https://docs.ansible.com/ansible/2.8/user_guide/playbooks_best_practices.html#directory-layout">Ansible Best Practices</a> document to further learn about the directory structure.
Modify the shell variable <code>PROJECT_PATH</code> to change the default project location.</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell"><span style="color:#fff;font-weight:bold">export</span> PROJECT_OWNER=<span style="color:#0ff;font-weight:bold">&#39;sitectl&#39;</span>
<span style="color:#fff;font-weight:bold">export</span> PROJECT_PATH=<span style="color:#0ff;font-weight:bold">&#34;/home/</span><span style="color:#0ff;font-weight:bold">${</span>PROJECT_OWNER<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">/manager&#34;</span>
mkdir <span style="color:#0ff;font-weight:bold">&#34;</span>$PROJECT_PATH<span style="color:#0ff;font-weight:bold">&#34;</span>
<span style="color:#fff;font-weight:bold">cd</span> <span style="color:#0ff;font-weight:bold">&#34;</span>$PROJECT_PATH<span style="color:#0ff;font-weight:bold">&#34;</span>
mkdir <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;collections&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;files&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;inventories&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;inventories/group_vars&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;inventories/host_vars&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;playbooks&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;vars&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;etc&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;filter_plugins&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;library&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;module_utils&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;roles&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;var&#39;</span> <span style="color:#0ff;font-weight:bold">\
</span><span style="color:#0ff;font-weight:bold"></span>  <span style="color:#0ff;font-weight:bold">&#39;templates&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>Create a simple shell script to set environment variables for Ansible. Refer to the <a href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html">Ansible Configuration</a> documentation to understand what are the <code>ANSIBLE_*</code> shell variables doing.</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">cat &gt; <span style="color:#0ff;font-weight:bold">&#39;load_environment.sh&#39;</span> <span style="color:#0ff;font-weight:bold">&lt;&lt;-EEOF
</span><span style="color:#0ff;font-weight:bold">#!/bin/bash
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">declare -x PROJECT_OWNER=&#39;$PROJECT_OWNER&#39;
</span><span style="color:#0ff;font-weight:bold">declare -x PROJECT_PATH=&#39;$PROJECT_PATH&#39;
</span><span style="color:#0ff;font-weight:bold">declare -x PROJECT_END_STATE=&#39;${PROJECT_PATH}/inventories&#39;
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">declare -x ANSIBLE_INVENTORY=&#34;\${PROJECT_END_STATE}/hosts.ini&#34;
</span><span style="color:#0ff;font-weight:bold">declare -x ANSIBLE_PRIVATE_KEY_FILE=&#34;/home/\${PROJECT_OWNER}/.ssh/id_rsa&#34;
</span><span style="color:#0ff;font-weight:bold">declare -x ANSIBLE_COLLECTIONS_PATHS=&#34;\${PROJECT_PATH}/collections&#34;
</span><span style="color:#0ff;font-weight:bold">declare -x ANSIBLE_ROLES_PATH=&#34;\${PROJECT_PATH}/roles&#34;
</span><span style="color:#0ff;font-weight:bold">declare -x ANSIBLE_GALAXY_CACHE_DIR=&#34;\${PROJECT_PATH}/var&#34;
</span><span style="color:#0ff;font-weight:bold">declare -x ANSIBLE_LOG_PATH=&#34;\${PROJECT_PATH}/var/ansible.log&#34;
</span><span style="color:#0ff;font-weight:bold">declare -x ANSIBLE_PYTHON_INTERPRETER=&#39;/usr/bin/python3.9&#39;
</span><span style="color:#0ff;font-weight:bold">declare -x ANSIBLE_PLAYBOOK_DIR=&#34;\${PROJECT_PATH}/playbooks&#34;
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">PATH=&#39;/home/${PROJECT_OWNER}/.local/bin:/usr/bin:/usr/sbin&#39;
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">EEOF</span>
</code></pre></td></tr></table>
</div>
</div><p>Create the Code Repository using GIT. Configure the <code>.gitignore</code> file to avoid tracking changes in the ansible-galaxy install location target (<code>collections/</code>) and in the repository for temporary and volatile files (<code>/var</code>)</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell"><span style="color:#fff;font-weight:bold">source</span> load_environment.sh
cat &gt; <span style="color:#0ff;font-weight:bold">&#39;.gitignore&#39;</span> <span style="color:#0ff;font-weight:bold">&lt;&lt;-EEOF
</span><span style="color:#0ff;font-weight:bold">collections/
</span><span style="color:#0ff;font-weight:bold">var/
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">EEOF</span>
git config user.email <span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">${</span>PROJECT_OWNER<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">@localhost.localdomain&#34;</span>
git config user.name <span style="color:#0ff;font-weight:bold">&#34;</span>$PROJECT_OWNER<span style="color:#0ff;font-weight:bold">&#34;</span>
git init
git add .
git commit -m <span style="color:#0ff;font-weight:bold">&#34;Initial commit&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="configure-ansible">Configure Ansible</h3>
<p>Install the latest Ansible engine to the control node user. This method keeps the environment isolated, minimizes os-distribution dependencies, and facilitates module upgrades.</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell"><span style="color:#0ff;font-weight:bold">&#34;</span>$ANSIBLE_PYTHON_INTERPRETER<span style="color:#0ff;font-weight:bold">&#34;</span> -m pip install ansible
</code></pre></td></tr></table>
</div>
</div><p>Prepare remote access to Ansible Managed Nodes using OpenSSH keys. Modify the shell variable <code>PROJECT_MANAGED_NODES</code> to represent your environment and set the <code>PROJECT_MANAGED_USER</code> variable to the remote user name with password-less root privilege.</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5">5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6">6</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">PROJECT_MANAGED_NODES=<span style="color:#0ff;font-weight:bold">&#39;host1 host2 host3 host4&#39;</span>
PROJECT_MANAGED_USER=<span style="color:#0ff;font-weight:bold">&#39;sysadmin&#39;</span>
ssh-keygen -t rsa -f <span style="color:#0ff;font-weight:bold">&#34;</span>$ANSIBLE_PRIVATE_KEY_FILE<span style="color:#0ff;font-weight:bold">&#34;</span> -N <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>
<span style="color:#fff;font-weight:bold">for</span> x in $PROJECT_MANAGED_NODES; <span style="color:#fff;font-weight:bold">do</span>
  ssh-copy-id -i <span style="color:#0ff;font-weight:bold">&#34;</span>$ANSIBLE_PRIVATE_KEY_FILE<span style="color:#0ff;font-weight:bold">&#34;</span> <span style="color:#0ff;font-weight:bold">${</span>PROJECT_MANAGED_USER<span style="color:#0ff;font-weight:bold">}</span>@<span style="color:#0ff;font-weight:bold">${</span>x<span style="color:#0ff;font-weight:bold">}</span>
<span style="color:#fff;font-weight:bold">done</span>
</code></pre></td></tr></table>
</div>
</div><p>Create the initial Ansible inventory registering the following <strong>Node</strong> groups:</p>
<ul>
<li><code>[control_node]</code>: defines the Ansible Node.</li>
<li><code>[managed_nodes]</code>: defines Ansible Managed nodes for the target site.</li>
<li><code>[office_nodes]</code>: defines <strong>Nodes</strong> that will consume the <strong>office-service</strong>. The service provides users with common productivity applications. For this example, we&rsquo;ll use the image editor GIMP.</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">cat &gt; <span style="color:#0ff;font-weight:bold">&#34;</span>$ANSIBLE_INVENTORY<span style="color:#0ff;font-weight:bold">&#34;</span> <span style="color:#0ff;font-weight:bold">&lt;&lt;-EEOF
</span><span style="color:#0ff;font-weight:bold">[control_node]
</span><span style="color:#0ff;font-weight:bold">localhost
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">[managed_nodes]
</span><span style="color:#0ff;font-weight:bold">$(for x in $PROJECT_MANAGED_NODES; do echo &#34;$x&#34;; done)
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">[office_nodes]
</span><span style="color:#0ff;font-weight:bold">$(for x in $PROJECT_MANAGED_NODES; do echo &#34;$x&#34;; done)
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">EEOF</span>
</code></pre></td></tr></table>
</div>
</div><p>Create end-state configuration repositories. This is where the infrastructure-model will be implemented.</p>
<ul>
<li><code>group_vars/</code>: one directory per host group</li>
<li><code>group_vars/host_group_x/</code>: one or more YAML files representing the components that will be available for all hosts in the group</li>
<li><code>host_vars/</code>: one directory per host</li>
<li><code>host_vars/hostx/</code>: one or more YAML files representing the components that will be available for the host</li>
</ul>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5">5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6">6</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell"><span style="color:#fff;font-weight:bold">for</span> x in control_node managed_nodes office_nodes; <span style="color:#fff;font-weight:bold">do</span>
  mkdir <span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">${</span>PROJECT_END_STATE<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">/group_vars/</span><span style="color:#0ff;font-weight:bold">${</span>x<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">&#34;</span>
<span style="color:#fff;font-weight:bold">done</span>
<span style="color:#fff;font-weight:bold">for</span> x in $PROJECT_MANAGED_NODES; <span style="color:#fff;font-weight:bold">do</span>
  mkdir <span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">${</span>PROJECT_END_STATE<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">/host_vars/</span><span style="color:#0ff;font-weight:bold">${</span>x<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">&#34;</span>
<span style="color:#fff;font-weight:bold">done</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="define-component-end-states">Define component end-states</h3>
<p>Now that the data repository for the infrastructure-model is created it can be populated with end-state targets. Notice that you can also add behaviour definitions to keep variable data separated from the code.</p>
<p>Define how is the Ansible engine going to connect to the managed nodes:</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5">5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6">6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7">7</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">cat &gt; <span style="color:#0ff;font-weight:bold">&#34;</span>$PROJECT_END_STATE<span style="color:#0ff;font-weight:bold">/group_vars/managed_nodes/ansible.yml&#34;</span> <span style="color:#0ff;font-weight:bold">&lt;&lt;-EEOF
</span><span style="color:#0ff;font-weight:bold">---
</span><span style="color:#0ff;font-weight:bold">ansible_user: &#34;$PROJECT_MANAGED_USER&#34;
</span><span style="color:#0ff;font-weight:bold">ansible_become_method: &#34;sudo&#34;
</span><span style="color:#0ff;font-weight:bold">...
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">EEOF</span>
</code></pre></td></tr></table>
</div>
</div><p>Define the attributes for the <code>Linux Users</code> component. This definition will be applied to all hosts in the group <code>managed_nodes</code>:</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">cat &gt; <span style="color:#0ff;font-weight:bold">&#34;</span>$PROJECT_END_STATE<span style="color:#0ff;font-weight:bold">/group_vars/managed_nodes/users.yml&#34;</span> <span style="color:#0ff;font-weight:bold">&lt;&lt;-EEOF
</span><span style="color:#0ff;font-weight:bold">---
</span><span style="color:#0ff;font-weight:bold">managed_nodes_users:
</span><span style="color:#0ff;font-weight:bold">  - name: &#34;user1&#34;
</span><span style="color:#0ff;font-weight:bold">    description: &#34;Regular User 1&#34;
</span><span style="color:#0ff;font-weight:bold">    uid: &#34;10100&#34;
</span><span style="color:#0ff;font-weight:bold">  - name: &#34;user2&#34;
</span><span style="color:#0ff;font-weight:bold">    description: &#34;Regular User 2&#34;
</span><span style="color:#0ff;font-weight:bold">    uid: &#34;10101&#34;
</span><span style="color:#0ff;font-weight:bold">...
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">EEOF</span>
</code></pre></td></tr></table>
</div>
</div><p>Define the attributes for the <code>Linux Package</code> component. This definition will be applied to all hosts in the group <code>office_nodes</code>:</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">cat &gt; <span style="color:#0ff;font-weight:bold">&#34;</span>$PROJECT_END_STATE<span style="color:#0ff;font-weight:bold">/group_vars/office_nodes/packages.yml&#34;</span> <span style="color:#0ff;font-weight:bold">&lt;&lt;-EEOF
</span><span style="color:#0ff;font-weight:bold">---
</span><span style="color:#0ff;font-weight:bold">office_nodes_packages:
</span><span style="color:#0ff;font-weight:bold">  flatpak:
</span><span style="color:#0ff;font-weight:bold">    - &#34;flatpak&#34;
</span><span style="color:#0ff;font-weight:bold">  gimp:
</span><span style="color:#0ff;font-weight:bold">    - &#34;org.gimp.GIMP&#34;
</span><span style="color:#0ff;font-weight:bold">...
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">EEOF</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="bring-the-site-to-the-target-end-state">Bring the site to the target end-state</h3>
<p>At this point end-state, and behaviour definitions are set. Now it&rsquo;s time to write the code that will apply it to the target hosts.</p>
<p>Create the Ansible Playbook that will configure the <code>managed_nodes</code> host group:</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">cat &gt; <span style="color:#0ff;font-weight:bold">&#34;</span>$ANSIBLE_PLAYBOOK_DIR<span style="color:#0ff;font-weight:bold">/managed_nodes.yml&#34;</span> <span style="color:#0ff;font-weight:bold">&lt;&lt;-EEOF
</span><span style="color:#0ff;font-weight:bold">---
</span><span style="color:#0ff;font-weight:bold">- name: &#34;Manage Ansible Nodes&#34;
</span><span style="color:#0ff;font-weight:bold">  hosts: &#34;managed_nodes&#34;
</span><span style="color:#0ff;font-weight:bold">  gather_facts: false
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">  tasks:
</span><span style="color:#0ff;font-weight:bold">    - name: &#34;Create Regular User Accounts&#34;
</span><span style="color:#0ff;font-weight:bold">      become: true
</span><span style="color:#0ff;font-weight:bold">      ansible.builtin.user:
</span><span style="color:#0ff;font-weight:bold">        create_home: true
</span><span style="color:#0ff;font-weight:bold">        state: &#34;present&#34;
</span><span style="color:#0ff;font-weight:bold">        name: &#34;{{ item[&#39;name&#39;] }}&#34;
</span><span style="color:#0ff;font-weight:bold">        comment: &#34;{{ item[&#39;description&#39;] | default( omit ) }}&#34;
</span><span style="color:#0ff;font-weight:bold">        uid: &#34;{{ item[&#39;uid&#39;] | default( omit ) }}&#34;
</span><span style="color:#0ff;font-weight:bold">      loop: &#34;{{ managed_nodes_users }}&#34;
</span><span style="color:#0ff;font-weight:bold">...
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">EEOF</span>
</code></pre></td></tr></table>
</div>
</div><p>Create the Ansible Playbook that will configure the <code>office_nodes</code> host group:</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20">20</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="21"><a style="outline: none; text-decoration:none; color:inherit" href="#21">21</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="22"><a style="outline: none; text-decoration:none; color:inherit" href="#22">22</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="23"><a style="outline: none; text-decoration:none; color:inherit" href="#23">23</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="24"><a style="outline: none; text-decoration:none; color:inherit" href="#24">24</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="25"><a style="outline: none; text-decoration:none; color:inherit" href="#25">25</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="26"><a style="outline: none; text-decoration:none; color:inherit" href="#26">26</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="27"><a style="outline: none; text-decoration:none; color:inherit" href="#27">27</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="28"><a style="outline: none; text-decoration:none; color:inherit" href="#28">28</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="29"><a style="outline: none; text-decoration:none; color:inherit" href="#29">29</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="30"><a style="outline: none; text-decoration:none; color:inherit" href="#30">30</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="31"><a style="outline: none; text-decoration:none; color:inherit" href="#31">31</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="32"><a style="outline: none; text-decoration:none; color:inherit" href="#32">32</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="33"><a style="outline: none; text-decoration:none; color:inherit" href="#33">33</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="34"><a style="outline: none; text-decoration:none; color:inherit" href="#34">34</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="35"><a style="outline: none; text-decoration:none; color:inherit" href="#35">35</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="36"><a style="outline: none; text-decoration:none; color:inherit" href="#36">36</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">cat &gt; <span style="color:#0ff;font-weight:bold">&#34;</span>$ANSIBLE_PLAYBOOK_DIR<span style="color:#0ff;font-weight:bold">/office_nodes.yml&#34;</span> <span style="color:#0ff;font-weight:bold">&lt;&lt;-EEOF
</span><span style="color:#0ff;font-weight:bold">---
</span><span style="color:#0ff;font-weight:bold">- name: &#34;Manage Office Nodes&#34;
</span><span style="color:#0ff;font-weight:bold">  hosts: &#34;office_nodes&#34;
</span><span style="color:#0ff;font-weight:bold">  gather_facts: false
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">  pre_tasks:
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">    - name: &#34;Install FlatPak tools&#34;
</span><span style="color:#0ff;font-weight:bold">      become: true
</span><span style="color:#0ff;font-weight:bold">      ansible.builtin.package:
</span><span style="color:#0ff;font-weight:bold">        name: &#34;{{ office_nodes_packages[&#39;flatpak&#39;] }}&#34;
</span><span style="color:#0ff;font-weight:bold">        state: &#34;present&#34;
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">    - name: &#34;Prepare FlatPak repository&#34;
</span><span style="color:#0ff;font-weight:bold">      become: true
</span><span style="color:#0ff;font-weight:bold">      ansible.builtin.command:
</span><span style="color:#0ff;font-weight:bold">        argv:
</span><span style="color:#0ff;font-weight:bold">          - &#34;/usr/bin/flatpak&#34;
</span><span style="color:#0ff;font-weight:bold">          - &#34;--system&#34;
</span><span style="color:#0ff;font-weight:bold">          - &#34;remote-add&#34;
</span><span style="color:#0ff;font-weight:bold">          - &#34;flatpak&#34;
</span><span style="color:#0ff;font-weight:bold">          - &#34;https://flathub.org/repo/flathub.flatpakrepo&#34;
</span><span style="color:#0ff;font-weight:bold">      register: result
</span><span style="color:#0ff;font-weight:bold">      changed_when:
</span><span style="color:#0ff;font-weight:bold">        - result[&#39;rc&#39;] == 0
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">  tasks:
</span><span style="color:#0ff;font-weight:bold">    - name: &#34;Install GIMP from FlatHub&#34;
</span><span style="color:#0ff;font-weight:bold">      become: true
</span><span style="color:#0ff;font-weight:bold">      community.general.flatpak:
</span><span style="color:#0ff;font-weight:bold">        name: &#34;{{ office_nodes_packages[&#39;gimp&#39;] }}&#34;
</span><span style="color:#0ff;font-weight:bold">        state: &#34;present&#34;
</span><span style="color:#0ff;font-weight:bold">...
</span><span style="color:#0ff;font-weight:bold">
</span><span style="color:#0ff;font-weight:bold">EEOF</span>
</code></pre></td></tr></table>
</div>
</div><p>Execute the playbooks to apply the end-state:</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">ansible-playbook playbooks/managed_nodes.yml
ansible-playbook playbooks/office_nodes.yml
</code></pre></td></tr></table>
</div>
</div><p>Save the changes to the repository:</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">git add inventories
git add playbooks
git commit -m <span style="color:#0ff;font-weight:bold">&#34;add office_node and managed_node plays&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="next-steps">Next steps</h2>
<p>Now the base structure is up and running more content can be added, either from Ansible Galaxy or developed in-house.</p>
<p>In addition to the automation engine and code repository you should evaluate incorporating:</p>
<ul>
<li>Code linters: <a href="https://ansible-lint.readthedocs.io/en/latest/">Ansible Lint</a> and <a href="https://yamllint.readthedocs.io/en/stable/">YAMLlint</a> can help to keep code consistent and standardized.</li>
<li>Testing: <a href="https://molecule.readthedocs.io/en/latest/">Ansible Molecule</a> can be used to build and run test environments for testing in-house roles</li>
<li>Provisioning: <a href="https://www.terraform.io/docs/index.html">Terraform</a> can be used to automate the creation of standardized VMs</li>
</ul>
<p>Explore the <a href="https://readthedocs.org/projects/aplatform64/">A:Platform64</a> project that facilitates the implementation of infrastructure-as-code by automating most of the tasks described in this tutorial.</p>
<h2 id="copyright-information">Copyright information</h2>
<p>This article is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. For copyright information on the product or products mentioned inhere refer to their respective owner.</p>
<h2 id="disclaimer">Disclaimer</h2>
<p>Opinions presented in this article are personal and belong solely to me, and do not represent people or organizations associated with me in a professional or personal way. All the information on this site is provided &ldquo;as is&rdquo; with no guarantee of completeness, accuracy or the results obtained from the use of this information.</p>

      </article>
    </section>

    

    

    
  </div>
</div>


            <footer class="ui basic center aligned segment" style="background-color: transparent;">
              
              <p> 2021 SerDigital64</p>
              

              <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</p>

              
            </footer>
          </div>
        </section>
        <section class="back">
          <div class="dream-max-width">
            <header class="ui basic very padded segment dream-header">
  
  <div class="ui small circular image">
    <img src="/about/SerDigital64-Font:ANSIShadow-circle.png" alt="avatar" />
  </div>
  

  <div class="content">
    <h1 class="ui medium header">SerDigital64&#39;s Blog<span class="sub header">Traveler log from my journey through the lands of the ever evolving  digital world</span>
    </h1>

    <article class="ui horizontal list">
      
      <a class="item" href="/categories">
        <i class="th list icon" title=""></i>
      </a>
      <a class="item" href="/tags">
        <i class="tags icon" title=""></i>
      </a>
    </article>

    
    
    
    
    
      
    
      
    
      
    
      
    
    

    

    

    
    

    <div class="tags-with-dropdown">
      <div class="ui accordion">
        <div class="title">
          <div class="ui horizontal list">
            <a class="item dropdown" href="#">
              <i class="chevron right icon dropdown-icon"></i>
            </a>
          </div>
          <div class="dream-tags">
          
          
          
            <a class="ui label" href="/tags/ansible/" title="ansible">
              ansible
            </a>
          
          
          
            <a class="ui label" href="/tags/automation/" title="automation">
              automation
            </a>
          
          
          
            <a class="ui label" href="/tags/images/" title="images">
              images
            </a>
          
          </div>
        </div>
        <div class="content">
    
          <div class="dream-tags" style="margin-left: 1.5rem;">
          
          
          
            <a class="ui label" href="/tags/infrastructure-as-code/" title="infrastructure-as-code">
              infrastructure-as-code
            </a>
          
          </div>
    
        </div>
      </div>
    </div>
    

    
  </div>
</header>


<div class="ui relaxed grid dream-grid dream-back">
  
  
  
  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article class="ui segment markdown-body">
      <div class="ui medium header">About SerDigital64</div>
      <div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-shell" data-lang="shell">


                         
                        
                          
                          
                          
                          
                                  
          
      
               
                
        
           
                                  
                                  
                                  
                                
                               
                                    
                                     


Linux &amp;&amp; OSS_advocate
Solutions_Architect = for_a_living
SysAdmin &amp;&amp; Developer = for_the_fun
Sci_Fi = fan
Photography &amp;&amp; DIY == enthusiast
                                                
</code></pre></div>
    </article>
  </div>
  

  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article class="ui segment">
      <div class="ui medium header"></div>
      <nav class="ui secondary menu dream-menu dream-socials">
  
  <a class="item" href="/index.xml">
    <i class="large rss square icon" title="RSS"></i>
  </a>
  

  
  <a class="item" href="mailto:serdigital64@gmail.com">
    <i class="large mail icon" title="Email"></i>
  </a>
  

  

  

  

  

  

  
  <a class="item" href="https://github.com/serdigital64" target="_blank">
    <i class="large github icon" title="GitHub"></i>
  </a>
  

  

  

  
</nav>

    </article>
  </div>

  <div class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    
    <article class="ui segment">
      Articles in this site are licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/)
    </article>
    
  </div>

  
</div>

          </div>
        </section>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>

    
    <div class="ui segment" id="dream-search">
  <div class="ui search">
    <div class="ui transparent input">
      <input class="prompt" type="text" placeholder="" />
    </div>
    <div class="results"></div>
  </div>
</div>
<script>
  $(document).ready(function () {
    $.getJSON('https:\/\/serdigital64.github.io/index.json', function (data) {
      $('.ui.search').search({
        source: data,
        searchFields: ['title'],
        showNoResults: false,
      })
    })
  })
</script>
<script src="/js/search.js"></script>

    

    

    <script>
  window.background = "#f7f7f7"
  window.defaultDark =  false 
  window.backgroundDark = "black"
  window.backgroundImageDark = "from-serdigital64-flicker/DSC_2253-tall.jpg"
  window.darkNav =  true 
  window.maxTags =  3 
  window.hasTwitterEmbed =  null 
  window.fixedNav =  true 

  if (window.hasTwitterEmbed) {
    
    window.twttr = (function (d, s, id) {
      var js,
        fjs = d.getElementsByTagName(s)[0],
        t = window.twttr || {}
      if (d.getElementById(id)) return t
      js = d.createElement(s)
      js.id = id
      js.src = 'https://platform.twitter.com/widgets.js'
      fjs.parentNode.insertBefore(js, fjs)

      t._e = []
      t.ready = function (f) {
        t._e.push(f)
      }

      return t
    })(document, 'script', 'twitter-wjs')
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@1.13.1/js/jquery.overlayScrollbars.min.js"></script>
<script src="/js/header.js"></script>
<script src="/js/main.js"></script>
<script src="/js/theme.js"></script>

    



<script src="/js/scrollToTop.js"></script>



<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.1"></script>
<script src="/js/post.js" defer></script>


    

    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-202533179-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
  </body>
</html>
